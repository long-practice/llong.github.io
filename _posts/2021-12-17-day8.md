---
title: 프로그래머스 인공지능 데브코스 8일차
layout: post
description: 1주차(21.12.13.(월) ~ 21.12.17.(금) 인공지능 수학
  선형대수
  자료의 정리
  확률과 확률분포
  추정, 검정, 엔트로피
tags:

- 확률
- 조합
- 확률의 덧셈 법칙
- 배반사건
- 조건부확률
- 독립사건
- 여사건
- 확률의 분할 법칙
- 베이즈 정리
- 확률변수
- 확률분포
- 이산확률변수
- 확률질량함수
- 연속확률변수
- 확률밀도함수
- 평균(기대값)
- 분산
- 표준편차
- 결합확률분포
- 주변확률분포
- 공분산
- 상관계수
- 이항분포
- 베르누이시행
- 정규분포
- 표준정규분포
- 포아송분포
- 지수분포

use_math: true

---

# 8일차(확률, 확률분포)

2주차(21.12.13.(월) ~ 21.12.17.(금)): 인공지능 수학

* 선형대수, 자료의 정리, 확률과 확률분포, 추정, 검정, 엔트로피 강의
* Jupyter Notebook, numpy를 이용한 실습

### 확률
* 똑같은 실험을 무수히 많이 반복할 때 어떤 일이 일어나는 비율
* 표본공간: 모든 가능한 실험결과들의 집합
* 사건: 관심있는 실험결과들의 집합으로 표본 공간의 부분집합
* 따라서 **어떤 사건이 일어날 확률 = 사건의 원소 수 / 표본공간의 원소의 수**

### 조합
* 어떤 집합에서 순서에 상관없이 뽑은 원소의 집합
<center>$_{n}\mathrm{C}_{r} = \begin{pmatrix} n\\r \end{pmatrix} = \frac{n!}{r!(n-r)!}$</center>

### 확률의 덧셈 법칙
* $P(A \cup B) = P(A) + P(B) - P(A \cap B)$
* 1 ~ 10까지의 카드 중에서 2 또는 3의 배수가 나올확률
* 풀이<br>
  $P(A)$: 2의 배수가 나올 확률 = 0.5<br>
  $P(B)$: 3의 배수가 나올 확률 = 0.3<br>
  $P(A\cap B)$: 2의 배수이면서 3의 배수일 확률 = 0.1<br>
  $P(A\cup B)$: 2의 배수혹은 3의 배수일 확률 = 0.5 + 0.3 - 0.1 = 0.7 <br>
  실제로 1 ~ 10의 경우 중 2, 3, 4, 6, 8, 9, 10 7가지의 경우가 해당이됨
* 두 사건의 교집합이 공집합일 경우 사건 A와 사건 B는 배반사건이라고 함(2의 배수가 나올 사건, 7의 배수가 나올사건)

### 조건부 확률
* 어떤 사건 A가 발생했을 때 B가 발생할 확률
<center> $P(B\mid A) = \frac{P(A \cap B)}{P(A)} (단, P(A) \ne 0)$ </center>
* 주사위를 던졌는데 4이하의 수가 나왔을 때, 그 수가 짝수일 확률?
* 사건 A: 4이하의 수가 나올 확률($\frac{2}{3}$)<br>
  사건 B: 4이하의 수 중 짝수가 나올 확률($\frac{1}{3}$)<br>
  $P(B\mid A) = \frac{P(A \cap B)}{P(A)} = \frac{1}{2}$<br>
  <br>
* 사건 A와 B가 독립일 경우 $P(B\mid A) = P(B)$ $\rightarrow P(B\cap A) = P(B)P(A) = P(A)P(B)$
* 예를 들어보면 주사위를 2개 던질 때 1번 주사위가 짝수일 사건, 2번 주사위가 짝수인 사건은 서로 독립

### 여사건
* 사건 A의 여사건은 사건 A가 일어나지 않을 사건($A^C$)
* 만약 사건 A가 주사위를 던졌을 때 주사위의 숫자가 짝수인 사건이라면<br>
  사건 A의 여사건은 주사위의 숫자가 홀수인 사건
* 어떤 사건과 그 여사건은 서로 배반
<center> $P(A \cup A^c) = P(A) + P(A^c) = 1$</center>
<center> $P(A) = 1 - P(A^c)$</center><br>


### 확률의 분할 법칙
* 사건 B는 사건 A에 대해 다음과 같이 정의가 가능 $ B = (A\cap B) \cup (A^c \cap B)$
* 이 때 $(A\cap B)$와 $(A^c \cap B)$는 서로 배반사건
* 따라서 확률을 다음과 같이 분할할 수 있음 $P(B) = P(A\cap B) \cup (P(A^c \cap B)$
* 조건부 확률에 따라 $P(B) = P(B \mid A)P(A) + P(B \mid A^c)P(A^c)$

### 베이즈 정리
* 추가적인 정보에 대하여 확률을 계산할 때 주로 적용함
<center>$P(A\mid B) = \frac{P(A \cap B)}{P(B)} = \frac{P(A \cap B)}{P(A\cap B) \cup P(A^c \cap B)} = \frac{P(B \mid A)P(A)}{P(B \mid A)P(A) + P(B \mid A^c)P(A^c)}$</center><br>
* 조금 더 일반화를 해보면 사건$B = {B_1, B_2, B_3, \cdots, B_k}$가 표본 공간 S의 분할일 때
<center>$P(B_{\gamma} \mid A) = \frac{P(B_{\gamma} \cap A)}{P(A)} = \frac{P(B_{\gamma} \cap A)}{\sum_{i = 1}^{k}P(B_{i}\cap A)} = \frac{P(B_{\gamma} \mid A)P(A)}{\sum_{i=1}^{k}P(B_i)P(A\mid B_i)}$</center><br>
* 위의 식을 말로 풀어서 설명하면 사건 $A$가 발생했을 때 $B_{\gamma}$가 일어날 확률은<br>
  사건 $A$와 $B_{\gamma}$가 동시에 벌어질 확률을 사건 $A$와 $B_1, B_2, \cdots, B_k$이 공통적으로 일어날 확률들을 모두 더한 값으로 나눈 값을 뜻함
  

<br><br>
#### 이산확률변수
* 확률변수가 취할 수 있는 모든 수의 값들을 셀 수 있을 경우
* 예를 들면 주사위의 눈, 동전 n개를 던졌을 때 앞면의 수...

<br><br>
#### 연속확률변수
* 확률변수가 취할 수 있는 모든 수가 연속적이어서 특정한 값으로 정의할 수 없는 경우
* 예를 들면 학생의 몸무게, 키...

### 확률변수
* 랜덤한 실험결과에 의존하는 실수, 즉, 표본 공간의 부분집합에 대응하는 실수
* 확률변수는 표본 공간에서 실수로 대응되는 함수로 정의
* 예를 들어 주사위 2개를 던지는 실험을 했을 때 주사위 숫자의 합 혹은 차, 동전 10개를 던졌을 때 앞면의 수

### 확률분포
* 확률변수가 가질 수 있는 값에대해 확률을 대응시켜주는 관계
* 확률변수 X가 x가 나올확률: 0.2 $\rightarrow P(X=x) = 0.2$<br>
<br>

* 이산확률변수의 확률분포는 보통 함수로 주어짐
* $P(X = x) = \frac{30x + 4}{200}$이라면<br>
  $P(X = 2) = \frac{64}{200} = 0.32$,  $P(X = 5) = \frac{154}{200} = 0.77$
  <br>

### 평균(기대값), 분산, 표준편차
<center>$E(x) = \sum P(X=x) = \sum xf(x)$</center>
<center>Var(x) = $\sigma^2(x) = \frac{1}{N}\sum(x_i - \mu)^2 = E(X^2) - [E(X)]^2$</center>
<center>SD(x) = $\sigma(x) = \sqrt{\sigma^2(x)}$</center>
예를 들어 주사위를 10만번 던졌을 때<br>
  1과 2가 나왔을 경우: 각 10000번<br>
  3과 4과 나왔을 경우: 각 25000번<br>
  5와 6이 나왔을 경우: 각 15000번<br>
<center>$E(x) = 1\times0.1 + 2\times0.1 + 3\times0.25 + 4\times0.25 + 5\times0.15 + 6\times0.15 = 3.7$</center>
<center>$\sigma^2(x)= (1 - 3.7)^2\times0.1 + (2 - 3.7)^2\times0.1 + (3 - 3.7)^2\times0.25+ (4 - 3.7)^2\times0.25 + (5 - 3.7)^2\times0.15 + (6 - 3.7)^2\times0.15 = 2.21$</center>
<center>$\sigma(x) = \sqrt{\sigma(x)} = 1.49$

### 결합확률분포
* 두 개 이상의 확률 변수가 동시에 취하는 값들에 대해 확률을 대응시켜주는 관계
* X: 한 학생이 가지는 휴대폰 수, Y: 한 학생이 가지는 노트북 수<br>
|Y\X| 1 | 2 | 3 |
|---|---|---|---|
|0|0.1|0.2|0|
|1|0|0.4|0.3|
* 위의 결합분포는 각 확률 변수의 확률분포로 도출이 가능(주변확률분포)
|x|0|1|2|
|---|---|---|---|
|P(X=x)|0.1|0.6|0.3| <br>

|y|0|1|
|---|---|---|
|P(Y=y)|0.3|0.7| <br>

### 공분산, 상관계수
* 공분산은 $(X - \mu_x)(Y - \mu_y)$의 평균
* 각 확률 변수의 절대적인 크기에 영향을 받음<br>
<center>$ Cov(X, Y) = E[(X - \mu_X)(Y - \mu_Y)] = E(XY) - \mu_X\mu_Y = E(XY) - E(X)E(Y)$ </center><br>
* 상관계수는 공분산을 각 X, Y의 표준편차로 나눈 것
<center>$ Corr(X, Y) = \frac{Cov(X, Y)}{\sigma_X\sigma_Y}$ </center><br>

### 이항분포
* **베르누이 시행은 정확히 2개의 결과만을 가지는 실험**
* 예를 들어 성공 혹은 실패, 동전 던지기를 했을 때 앞면 혹은 뒷면
* 이에따라 확률변수 X는 n번의 베르누이 시행에서 성공횟수(이항확률변수)
* 이항분포는 이항확률변수의 확률분포를 말함
<center>$f(x) = P(X = x) = \begin{pmatrix} n\\x \end{pmatrix}p^x(1-p)^{n - x}$</center>
* 각각의 확률은 $x$에 해당 값을 대입하여 구할 수 있음($n$에는 전체 경우의 수, $p$는 성공할 확률)


```python
# 주머니 안에 빨간 공을 뽑을 확률이 0.4
# 공 3개를 뽑았을 때 적어도 한 번 빨간 공을 뽑을 확률(P(X >= 1) = 1 - P(X = 0))
from scipy import stats

print(1 - stats.binom.cdf(0, n = 3, p = 0.4))
```

    0.784


* 이항분포의 평균, 분산, 표준편차는 다음과 같음
<center>$E(x) = np$<br>$Var(x) = np(1-p)$<br>$SD(x) = \sqrt{np(1-p)}$</center>



```python
# 이항분포의 평균, 분산
print(stats.binom.stats(n = 3, p = 0.4))
```

    (array(1.2), array(0.72))


### 정규분포
* 연속확률 변수의 확률은 주로 확률밀도함수f(x)로 표현하는 것이 일반적
* 그래프 아래 부분의 넓이가 확률이 됨
<center>$P[a \le X \le b] = \int_a^b f(x)\ dx$</center>
* 정규분포의 확률밀도함수는 종모양의 그래프로 다음과 같음
<center>$f(x) = \frac{1}{\sqrt{2\pi}\sigma}$$e^{-\frac{(x-\mu)}{2\sigma}^2}$</center>
* 확률변수 $X$의 평균이 $\mu$, 분산이 $\sigma^2$이고, 정규분포를 따를 때 $X\sim N(\mu, \sigma^2)$로 표현
<br><br>
* 표준정규확률변수 $Z = \frac{X - \mu}{\sigma}$로 변환하게 되면 $Z \sim N(0, 1)$이며, 표준정규분포표를 이용하여 확률을 구함$P[Z \le z]$


```python
# X ~ N(4, 3**2)
# P[X <= 4] = ?
print('P[X <= 4] = ')
print(stats.norm.cdf(4, loc = 4, scale = 3))

print()

# P[4 <= X <= 7] = P[X <= 7] - P[X < 4]?
# 실제로는 표준정규분포로변환 P[0 <= Z <= 1] 이후 표준정규분포표를 이용하여 확률을 구함
print('P[4 <= X <= 7] = ')
print(stats.norm.cdf(7, loc = 4, scale = 3) - stats.norm.cdf(4, loc = 4, scale = 3))
```

    P[X <= 4] = 
    0.5
    
    P[4 <= X <= 7] = 
    0.3413447460685429


### 포아송 분포
* 일정한 시간단위 또는 공간 단위에서 발생하는 이벤트의 수의 확률분포
* 에를 들면 하루동안 어떤 식당에 방문하는 손님 수, 어떤 전기선 100m당 발생하는 결함의 수
* 확률분포함수(확률질량함수)는 다음과 같다
<center>$P[X = x] = f(x) = \lambda^x \frac{e^{-\lambda}}{x!}, x = 0, 1, 2, \cdots$(평균: $\lambda$, 분산: $\lambda$)</center><br>
* 방사선 입자 2.5(ms)동안 방사선 입자 개수가 15일 확률은?(1(ms)당 4개의 방사선 입자가 나옴)<br>
  (풀이) 2.5(ms)동안 방사선 입자는 평균적으로 10개가 나오므로 포아송분포를 적용($\lambda = 10$)
<center>$P[X = 15] = f(15) = 10^{15}\frac{e^{-15}}{15!} = 0.034$</center>


```python
# 코드로 풀이
# P[X = 15] = ?
print(stats.poisson.cdf(15, mu = 10) - stats.poisson.cdf(14, mu = 10))
```

    0.034718069630684134


### 지수분포
* 포아송 분포에 의해 어떤 사건이 발생할 때, 어느 한 시점으로부터 이 사건이 발생할 때까지 걸리는 시간에 대한 확률 분포
* 확률밀도함수, 평균, 분산은 다음과 같다
<center>$ f(t) = \lambda e^{-\lambda t}$ ($\lambda$: 포아송 분포의 평균)</center>
<center>$E(T) = \frac{1}{\lambda}, Var(T) = \frac{1}{\lambda^2}$</center>
* 어느 웹사이트에 시간당 접속자 수는 $\lambda$ = 3인 포아송 분포를 따를 때,<br>
  지금부터 시작하여 첫번째 접속자가 30분 이내에 올 확률? $\rightarrow P[T \le 0.5]$ 
<center>$P[T \le 0.5] = \int_{0}^{0.5}\lambda e^{-\lambda t}\ dt = \int_{0}^{0.5} 3 e^{-3t}\ dt = [-e^{-3t}]_0^{0.5} = 1 - e^{-1.5} = 1 - 0.2231 = 0.7769$</center>


```python
# 코드로 풀이
lam = 3
print(stats.expon.cdf(0.5, scale = 1/lam))
```

    0.7768698398515702


### 느낀점
알고있는 내용도 있으나 조금 더 심도 있게 공부해야할 부분이 있었다(베이즈 정리)<br>
영어 번역, 해석하듯이 계산하면서 풀면쉬울 수 있으나 라이브 세션에서 confusion matrix와 매칭시킬줄 알아야겠다고 생각했다.<br>
이 부분에서는 추가적인 학습이 필요해보이며, 통계부분또한 알고 있는 내용이 대부분이었지만<br>
지수분포, 포아송분포에 대해서는 추가적인 예제를 풀어보며 적응을 해야겠다고 생각했다.
